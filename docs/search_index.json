[["assignment-4-part-2-lagos-spacial-analysis.html", "Chapter 6 Assignment 4: Part 2 LAGOS Spacial Analysis 6.1 Class work", " Chapter 6 Assignment 4: Part 2 LAGOS Spacial Analysis 6.0.1 Loading in data, first download and then specifically grab the locus (or site lat longs) #Lagos download script #lagosne_get(dest_folder = LAGOSNE:::lagos_path(),overwrite=T) #Load in lagos lagos &lt;- lagosne_load() ## Warning in (function (version = NULL, fpath = NA) : LAGOSNE version unspecified, ## loading version: 1.087.3 #Grab the lake centroid info lake_centers &lt;- lagos$locus # Make an sf object spatial_lakes &lt;- st_as_sf(lake_centers,coords=c(&#39;nhd_long&#39;,&#39;nhd_lat&#39;), crs=4326) #Grab the water quality data nutr &lt;- lagos$epi_nutr #Look at column names #names(nutr) 6.0.2 Subset columns nutr to only keep key info that we want clarity_only &lt;- nutr %&gt;% select(lagoslakeid,sampledate,chla,doc,secchi) %&gt;% mutate(sampledate = as.character(sampledate) %&gt;% ymd(.)) 6.0.3 Keep sites with at least 200 observations #Look at the number of rows of dataset #nrow(clarity_only) chla_secchi &lt;- clarity_only %&gt;% filter(!is.na(chla), !is.na(secchi)) # How many observatiosn did we lose? # nrow(clarity_only) - nrow(chla_secchi) # Keep only the lakes with at least 200 observations of secchi and chla chla_secchi_200 &lt;- chla_secchi %&gt;% group_by(lagoslakeid) %&gt;% mutate(count = n()) %&gt;% filter(count &gt; 200) 6.0.4 Join water quality data to spatial data spatial_200 &lt;- inner_join(spatial_lakes,chla_secchi_200 %&gt;% distinct(lagoslakeid,.keep_all=T), by=&#39;lagoslakeid&#39;) 6.0.5 Mean Chl_a map ### Take the mean chl_a and secchi by lake mean_values_200 &lt;- chla_secchi_200 %&gt;% # Take summary by lake id group_by(lagoslakeid) %&gt;% # take mean chl_a per lake id summarize(mean_chl = mean(chla,na.rm=T), mean_secchi=mean(secchi,na.rm=T)) %&gt;% #Get rid of NAs filter(!is.na(mean_chl), !is.na(mean_secchi)) %&gt;% # Take the log base 10 of the mean_chl mutate(log10_mean_chl = log10(mean_chl))%&gt;% #Take the log base 10 of the mean_secchi mutate(log10_mean_secchi = log10(mean_secchi)) #Join datasets mean_spatial &lt;- inner_join(spatial_lakes,mean_values_200, by=&#39;lagoslakeid&#39;) #Make a map mapview(mean_spatial,zcol=&#39;log10_mean_chl&#39;) 6.1 Class work 6.1.1 1) What is the correlation between Secchi Disk Depth and Chlorophyll a for sites with at least 200 observations? Here, I just want a plot of chla vs secchi for all sites #Your code here ggplot(chla_secchi_200, aes(y = chla, x = secchi))+ geom_point(size = 1, shape = 1)+ scale_x_log10()+ scale_y_log10() 6.1.2 Why might this be the case? When there is more chlorophyll in the water it is more turbid and therefore harder to see the Secchi disk. 6.1.3 2) What states have the most data? 6.1.4 2a) First you will need to make a lagos spatial dataset that has the total number of counts per site. ## Your code here site_counts&lt;-nutr%&gt;% group_by(lagoslakeid)%&gt;% summarize(count = n()) spatial_counts&lt;-inner_join(spatial_lakes, site_counts%&gt;% distinct(lagoslakeid,.keep_all = T), by = &quot;lagoslakeid&quot;) 6.1.5 2b) Second, you will need to join this point dataset to the us_boundaries data. ## Your code here states_lagos&lt;-lagos$state states_lakes &lt;- inner_join(spatial_counts, states_lagos, by=&quot;state_zoneid&quot;) 6.1.6 2c) Then you will want to group by state and sum all the observations in that state and arrange that data from most to least toatl observations per state. ## Your code here. sum_states&lt;-states_lakes%&gt;% as.data.frame()%&gt;% select(-geometry)%&gt;% group_by(state_name)%&gt;% summarize(sum_counts = sum(count))%&gt;% arrange(desc(sum_counts)) head(sum_states) ## # A tibble: 6 Ã— 2 ## state_name sum_counts ## &lt;chr&gt; &lt;int&gt; ## 1 Minnesota 358009 ## 2 Wisconsin 145897 ## 3 Michigan 100738 ## 4 Maine 87512 ## 5 New York 35776 ## 6 Vermont 24797 Minnesota has the most data followed by Wisconsin and Michigan 6.1.7 3 Is there a spatial pattern in Secchi disk depth for lakes with at least 200 observations? ## Your code here mean_spatial%&gt;% arrange(-mean_secchi) %&gt;% mapview(.,zcol = &#39;mean_secchi&#39;) mapview(mean_spatial,zcol=&#39;log10_mean_secchi&#39;) There is not a spatial pattern in Secchi disk depths, there are some clusters of locations where there are many lakes with more than 200 observations but this has more to do with lake density than Secchi disk depths. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
